{% extends 'base.html' %}
{% block title %}drp — how it works{% endblock %}

{% block content %}
<div class="help-page">
  <h1>how it works</h1>
  <p class="tagline">drp is a drop point for text and files. pick a key, drop something, share the link.</p>

  <nav class="help-nav">
    <a href="#concepts">concepts</a>
    <a href="#expiry">expiry</a>
    <a href="#cli">cli</a>
    <a href="#accounts">accounts</a>
    <a href="#privacy">privacy</a>
  </nav>

  <!-- ── Concepts ── -->
  <section id="concepts">
    <h2>concepts</h2>

    <h3>namespaces</h3>
    <p>Text and files live in separate namespaces so their keys never collide:</p>
    <table>
      <tr><th>URL</th><th>type</th></tr>
      <tr><td><code>/key/</code></td><td>clipboard (text)</td></tr>
      <tr><td><code>/f/key/</code></td><td>file</td></tr>
    </table>
    <p><code>/notes/</code> is a clipboard. <code>/f/notes/</code> is a file. They're independent.</p>

    <h3>locking</h3>
    <p><strong>Anonymous drops</strong> get a 24-hour creation lock — nobody can overwrite or rename the key during that window. After 24h, anyone with the key can replace it.</p>
    <p><strong>Paid drops</strong> are permanently locked to your account — only you can edit, rename, delete, or renew them.</p>

    <h3>saved drops</h3>
    <p>You can bookmark any drop you didn't create — useful for drops shared with you. Saved drops appear in your account dashboard and export. Saving grants no edit or delete rights.</p>
  </section>

  <!-- ── Expiry ── -->
  <section id="expiry">
    <h2>expiry</h2>

    <h3>clipboards (activity-based)</h3>
    <p>Clipboards don't expire on a fixed timer. They idle out when nobody accesses them — like a pastebin that stays alive as long as people still care.</p>
    <table>
      <tr><th>tier</th><th>idle timeout</th><th>max lifetime</th></tr>
      <tr><td>Anonymous</td><td>24h since last access</td><td>7 days</td></tr>
      <tr><td>Free account</td><td>48h since last access</td><td>30 days</td></tr>
      <tr><td>Starter / Pro</td><td>explicit date you set</td><td>1–3 years</td></tr>
    </table>

    <h3>files</h3>
    <p>Anonymous files expire <strong>90 days after upload</strong> regardless of access. Paid accounts set explicit dates and can renew.</p>

    <h3>renewing</h3>
    <p>Paid drops can be renewed — this resets the expiry forward by the same duration as the original. There's no renewal limit. Use <code>drp renew key</code> or the renew button on the drop page.</p>
  </section>

  <!-- ── CLI ── -->
  <section id="cli">
    <h2>cli</h2>

    <h3>install</h3>
    <pre><code>pipx install drp-cli
drp setup          # set host, log in</code></pre>

    <h3>uploading</h3>
    <pre><code>drp up "hello world"             # clipboard → /auto-key/
drp up "hello world" -k hello    # clipboard at /hello/
drp up notes.txt                 # file → /f/notes/
drp up report.pdf -k q3          # file at /f/q3/</code></pre>
    <p>Text → clipboard namespace. Files → file namespace. The <code>-k</code> flag sets your key on creation — do it then, because keys are locked for 24h.</p>

    <h3>getting</h3>
    <pre><code>drp get hello                    # print clipboard to stdout
drp get q3                       # auto-detect: clipboard first, then file
drp get f/q3                     # force file namespace
drp get f/q3 -o my-report.pdf    # download and save with custom name</code></pre>

    <h3>listing</h3>
    <pre><code>drp ls                           # keys only
drp ls -l                        # long: kind, size, age, expiry
drp ls -l --bytes                # long with raw byte counts
drp ls -l -t c                   # only clipboards
drp ls -l -t f                   # only files
drp ls -l -t s                   # only saved (bookmarked) drops
drp ls -l --sort time            # sort by age
drp ls -l --sort size -r         # sort by size, reversed
drp ls --export > backup.json    # dump as JSON (requires login)</code></pre>

    <h3>managing</h3>
    <pre><code>drp rm hello                     # delete clipboard
drp rm f/q3                      # delete file
drp mv q3 quarter3               # rename key (blocked 24h after creation)
drp mv f/q3 f/quarter3           # rename file key
drp renew q3                     # extend expiry (paid accounts only)</code></pre>

    <h3>importing / exporting</h3>
    <pre><code>drp ls --export > backup.json    # export your drops as JSON
drp load backup.json             # import a shared export as saved drops</code></pre>
    <p><code>drp load</code> bookmarks all drops from the export file as saved drops on your account. No content is transferred and no ownership is granted — you can view them but not edit or delete them.</p>

    <h3>account &amp; session</h3>
    <pre><code>drp setup                        # configure host and log in
drp login                        # log in (session saved locally)
drp logout                       # clear saved session
drp status                       # show host, account, session info
drp ping                         # check server connectivity</code></pre>
    <p>Session cookies are saved in <code>~/.config/drp/session.json</code> — no password prompt on every command. Run <code>drp logout</code> to clear.</p>

    <h3>key tips</h3>
    <p>Always use <code>-k</code> when you want a memorable URL — set it at upload time, before the 24h lock kicks in. Keys can contain letters, numbers, hyphens, dots, and most non-slash characters. Clipboards and files can share a key name without conflict.</p>
  </section>

  <!-- ── Accounts ── -->
  <section id="accounts">
    <h2>accounts</h2>
    <table>
      <tr><th></th><th>Anonymous</th><th>Free</th><th>Starter $3/mo</th><th>Pro $8/mo</th></tr>
      <tr><td>Max file</td><td>200 MB</td><td>200 MB</td><td>1 GB</td><td>5 GB</td></tr>
      <tr><td>Max clipboard</td><td>500 KB</td><td>500 KB</td><td>2 MB</td><td>10 MB</td></tr>
      <tr><td>Storage quota</td><td>—</td><td>—</td><td>5 GB</td><td>20 GB</td></tr>
      <tr><td>Clipboard idle</td><td>24h</td><td>48h</td><td>explicit</td><td>explicit</td></tr>
      <tr><td>Max lifetime</td><td>7 days</td><td>30 days</td><td>1 year</td><td>3 years</td></tr>
      <tr><td>Locked drops</td><td>✗</td><td>✗</td><td>✓</td><td>✓</td></tr>
      <tr><td>Renewable</td><td>✗</td><td>✗</td><td>✓</td><td>✓</td></tr>
      <tr><td>Saved drops</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td></tr>
      <tr><td>Export / import</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td></tr>
    </table>
    <p>Free accounts sync drops across devices, unlock saved/bookmarked drops, and let you export and import shared collections. No credit card required.</p>
  </section>

  <!-- ── Privacy ── -->
  <section id="privacy">
    <h2>privacy</h2>
    <p>drp is <a href="https://github.com/vicnasdev/drp">open source</a>. Files are stored on Cloudinary. Text is stored in PostgreSQL. There is no encryption at rest — don't store secrets or sensitive data. A hard-to-guess key is your only protection for anonymous drops.</p>
    <p>Questions or bugs → <a href="https://github.com/vicnasdev/drp/issues">open an issue on GitHub</a>.</p>
  </section>
</div>
{% endblock %}